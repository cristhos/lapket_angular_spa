{"version":3,"file":"/home/lithos/Data/Lab/codash/angularSpa/src/app/user/common/register-social.component.ts","sources":["/home/lithos/Data/Lab/codash/angularSpa/src/app/user/common/register-social.component.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,sCAAkD;AAClD,wDAAuD;AAUvD,IAAa,uBAAuB;IAalC,iCAAoB,WAAyB;QAAzB,gBAAW,GAAX,WAAW,CAAc;QAV7C,UAAK,GAAG;YACN,QAAQ,EAAE;gBACR,UAAU,EAAE,0EAA0E;aACvF;YACD,UAAU,EAAE;gBACV,UAAU,EAAE,kBAAkB;gBAC9B,YAAY,EAAE,MAAM;aACrB;SACF,CAAC;IAE6C,CAAC;IAEhD,0CAAQ,GAAR;QACE,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;QACjD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;IAC/C,CAAC;IACD,2DAA2D;IAC3D,oEAAoE;IACpE,iDAAe,GAAf;QACE,EAAE,CAAC,cAAc,CAAC,UAAS,QAAQ;YACvB,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC;gBAClC,YAAY;gBACZ,KAAK,CAAC,4DAA4D,CAAC,CAAC;gBACpE,uFAAuF;YAC3F,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,iBAAiB;gBACjB,EAAE,CAAC,KAAK,CAAC,UAAS,QAAQ;oBACtB,EAAE,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAA,CAAC;wBAEvB,KAAK,CAAC,eAAe,CAAC,CAAC;wBACvB,uFAAuF;oBAC3F,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACJ,KAAK,CAAC,YAAY,CAAC,CAAC;oBACxB,CAAC;gBACL,CAAC,EAAE,EAAC,KAAK,EAAE,OAAO,EAAC,CAAC,CAAC;YACzB,CAAC;QACb,CAAC,CAAC,CAAC;IAEL,CAAC;IAED,wDAAwD;IACxD,oEAAoE;IACpE,+CAAa,GAAb;QAAA,iBAiBC;QAhBC,EAAE,CAAC,CAAC,OAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,WAAW,CAAC,CAAA,CAAC;YACnC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC;QAC9C,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;YACrB,IAAI,OAAO,GAAG,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,eAAe,EAAE,CAAC;YAC7D,IAAI,OAAO,GAAG,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,eAAe,EAAE,CAAC,QAAQ,CAAC;YACtE,KAAI,CAAC,IAAI,GAAG;gBACE,KAAK,EAAE,OAAO;gBACd,GAAG,EAAE,OAAO,CAAC,KAAK,EAAE;gBACpB,IAAI,EAAE,OAAO,CAAC,OAAO,EAAE;gBACvB,KAAK,EAAE,OAAO,CAAC,QAAQ,EAAE;gBACzB,KAAK,EAAE,OAAO,CAAC,WAAW,EAAE;gBAC5B,QAAQ,EAAE,QAAQ;aACnB,CAAC;QAClB,CAAC,CAAC,CAAA;IAEJ,CAAC;IAED,8CAA8C;IAC9C,qDAAmB,GAAnB,UAAoB,IAAI;QAEtB,IAAI,CAAC,GAAG,QAAQ,EAAE,IAAI,EAAE,EAAE,GAAG,gBAAgB,EAAE,GAAG,GAAG,CAAC,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAEzF,EAAE,CAAA,CAAC,CAAC,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,IAAI,CAAC,CAAA,CAAC;YAC7C,IAAI,GAAG,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACjC,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YAClB,IAAI,CAAC,GAAG,GAAG,qCAAqC,CAAC;YAEjD,IAAI,CAAC,MAAM,GAAG;gBACZ,EAAE,CAAC,IAAI,CAAC;oBACJ,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC;oBACvB,MAAM,EAAE,IAAI;oBACZ,MAAM,EAAE,IAAI;oBACZ,KAAK,EAAE,IAAI;oBACX,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC;iBAC9B,CAAC,CAAC;YACL,CAAC,CAAC;YACF,GAAG,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACzC,CAAC;IACH,CAAC;IAED,+CAA+C;IAC/C,mDAAiB,GAAjB,UAAkB,IAAI;QACpB,IAAI,CAAC,GAAG,QAAQ,EAAE,GAAG,EAAE,EAAE,GAAG,gBAAgB,EAAE,GAAG,GAAG,CAAC,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAExF,EAAE,CAAA,CAAC,CAAC,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,IAAI,CAAC,CAAA,CAAC;YAC7C,GAAG,GAAG,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAChC,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC;YACZ,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC;YACjB,GAAG,CAAC,GAAG,GAAG,kCAAkC,CAAC;YAE7C,GAAG,CAAC,MAAM,GAAG;gBACT,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;oBACf,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;wBACZ,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;wBAC3B,KAAK,EAAE,OAAO;qBACjB,CAAC,CAAA;gBACR,CAAC,CAAC,CAAA;YACJ,CAAC,CAAA;YAED,GAAG,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QACxC,CAAC;IACH,CAAC;IACH,8BAAC;AAAD,CAAC,AA9GD,IA8GC;AA9GY,uBAAuB;IALnC,gBAAS,CAAC;QACT,QAAQ,EAAE,iBAAiB;QAC3B,WAAW,EAAE,kCAAkC;KAChD,CAAC;qCAekC,0BAAW;GAblC,uBAAuB,CA8GnC;AA9GY,0DAAuB","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {  UserService } from '../service/user.service';\n\ndeclare let gapi: any;\ndeclare let FB: any;\n\n@Component({\n  selector: 'register-social',\n  templateUrl: './register-social.component.html'\n})\n\nexport class RegisterSocialComponent implements OnInit {\n  user : any;\n  gauth:any;\n  infos = {\n    \"google\": {\n      \"clientId\": \"930057129388-e7uhda305urca6q607aqkj6jjlskqs3b.apps.googleusercontent.com\"\n    },\n    \"facebook\": {\n      \"clientId\": \"1789365264721334\",\n      \"apiVersion\": \"v2.4\"\n    }\n  };\n\n  constructor(private userService : UserService){}\n  \n  ngOnInit(){\n    this.initFacebookConnect(this.infos['facebook']);\n    this.initGoogleConnect(this.infos['google']);\n  }\n  //recuperer les informations fourni par notre apps facebook\n  //enregistrer si ce la premiere fois, connecter site ce la Neme fois\n  facebookConnect(){\n    FB.getLoginStatus(function(response) {\n                if (response.status === 'connected') {\n                    // connected\n                    alert('Already connected, redirect to login page to create token.');\n                    //document.location = \"{{ url(\"hwi_oauth_service_redirect\", {service: \"facebook\"}) }}\";\n                } else {\n                    // not_authorized\n                    FB.login(function(response) {\n                        if (response.authResponse){\n                            \n                            alert('new connexion');\n                            //document.location = \"{{ url(\"hwi_oauth_service_redirect\", {service: \"facebook\"}) }}\";\n                        } else {\n                            alert('Cancelled.');\n                        }\n                    }, {scope: 'email'});\n                }\n    });\n\n  }\n \n  //recuperer les informations fourni par notre app google\n  //enregistrer si ce la premiere fois, connecter site ce la Neme fois\n  googleConnect(){\n    if (typeof(this.gauth) == \"undefined\"){\n        this.gauth = gapi.auth2.getAuthInstance();\n    }\n    this.gauth.signIn().then(() => {\n        let profile = this.gauth.currentUser.get().getBasicProfile();\n        let idToken = this.gauth.currentUser.get().getAuthResponse().id_token;\n        this.user = {\n                      token: idToken,\n                      uid: profile.getId(),\n                      name: profile.getName(),\n                      email: profile.getEmail(),\n                      image: profile.getImageUrl(),\n                      provider: \"google\"\n                    };                        \n    })\n    \n  }\n\n  //load facebooksdk and initialise facebook app\n  initFacebookConnect(info){\n    \n    let d = document, fbJs, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];\n\n    if(d.getElementById('facebook-jssdk') == null){\n      fbJs = d.createElement('script');\n      fbJs.id = id;\n      fbJs.async = true;\n      fbJs.src = \"//connect.facebook.net/en_US/sdk.js\";\n\n      fbJs.onload = function() {\n        FB.init({\n            appId: info[\"clientId\"],\n            status: true,\n            cookie: true,\n            xfbml: true,\n            version: info[\"apiVersion\"]\n        });\n      };\n      ref.parentNode.insertBefore(fbJs, ref);\n    }\n  }\n  \n  //load google plateformjs initialise google app\n  initGoogleConnect(info){\n    let d = document, gJs, id = 'googleplatform', ref = d.getElementsByTagName('script')[0];\n\n    if(d.getElementById('googleplatform') == null){\n      gJs = d.createElement('script');\n      gJs.id = id;\n      gJs.async = true;\n      gJs.src = \"//apis.google.com/js/platform.js\";\n\n      gJs.onload = function() {\n          gapi.load('auth2', function() {\n              gapi.auth2.init({\n                  client_id: info[\"clientId\"],\n                  scope: 'email'\n              })\n        })\n      }\n\n      ref.parentNode.insertBefore(gJs, ref);\n    }\n  }\n}\n"]}